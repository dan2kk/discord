(function(){"use strict";var e={3945:function(e,t,n){var s=n(9242),o=n(3396);function r(e,t,n,s,r,a){const i=(0,o.up)("router-view");return(0,o.wg)(),(0,o.j4)(i)}var a={name:"App",computed:{isLogined(){return this.$store.getters.getIsLogined}}},i=n(89);const l=(0,i.Z)(a,[["render",r]]);var c=l,u=n(2483),d=n.p+"img/ok.69c5ab13.svg";const g={id:"login"},m=(0,o._)("header",null,[(0,o._)("h1",{class:"loginText"},"로그인")],-1),h={class:"loginBox"},p={class:"inputWrapper"},f={key:0,class:"checkImg1",src:d,alt:""},w={class:"inputWrapper"},v={key:0,class:"checkImg2",src:d,alt:""},y={class:"nav"};function I(e,t,n,r,a,i){const l=(0,o.up)("router-link");return(0,o.wg)(),(0,o.iD)("div",g,[m,(0,o._)("main",h,[(0,o._)("div",p,[(0,o.wy)((0,o._)("input",{class:"inputBox",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.userId=e),placeholder:"ID"},null,512),[[s.nr,a.userId]]),a.userId.length>=4?((0,o.wg)(),(0,o.iD)("img",f)):(0,o.kq)("",!0)]),(0,o._)("div",w,[(0,o.wy)((0,o._)("input",{class:"inputBox",type:"password","onUpdate:modelValue":t[1]||(t[1]=e=>a.userPw=e),onKeyup:t[2]||(t[2]=(0,s.D2)(((...e)=>i.login&&i.login(...e)),["enter"])),placeholder:"비밀번호"},null,544),[[s.nr,a.userPw]]),a.userPw.length>=6?((0,o.wg)(),(0,o.iD)("img",v)):(0,o.kq)("",!0)]),(0,o._)("button",{class:"loginButton",onClick:t[3]||(t[3]=(...e)=>i.login&&i.login(...e))},"로그인")]),(0,o._)("nav",y,[(0,o._)("ul",null,[(0,o._)("li",null,[(0,o.Wm)(l,{to:"/create"},{default:(0,o.w5)((()=>[(0,o.Uk)("회원가입")])),_:1})]),(0,o._)("li",null,[(0,o.Wm)(l,{to:"/find"},{default:(0,o.w5)((()=>[(0,o.Uk)("비밀번호 찾기")])),_:1})])])])])}n(7658);var k=n(2066),_=n(4161),L=n(4870),b=n(65),x=(0,b.MT)({state:{serverURL:window.location.protocol+"//"+window.location.host,userInfo:{userId:"",userPw:"",userName:""},isLogined:!1},getters:{getServerURL(e){return e.serverURL},getUserInfo(e){return e.userInfo},getIsLogined(e){return e.isLogined}},mutations:{setuserInfo(e,t){e.userInfo.userId=t.userId,e.userInfo.userPw=t.userPw,e.userInfo.userName=t.userName,console.log(e.userInfo)},setIsLogined(e,t){t?e.isLogined=!0:(e.userInfo.userId="",e.userInfo.userPw="",e.userInfo.userName="",e.userInfo.userToken="",e.isLogined=!1)}},actions:{},modules:{}}),N=n(1113);const C=(0,L.qj)({connected:!1,userName:null,channelList:[],userList:[],nowChannel:null,messageList:[],peerId:null}),S=window.location.protocol+"//"+window.location.host,P={iceServers:[{urls:"stun:stun.stunprotocol.org:3478"},{urls:"stun:stun.l.google.com:19302"}]};let D={video:!0,audio:!0};const U=(0,k.io)(S);function O(){C.userName||(C.userName=x.state.userInfo.userName),console.log(C.userName),U.emit("login",JSON.stringify({name:C.userName}))}function M(e,t,n){U.emit("channelCreate",JSON.stringify({name:C.userName,channelName:e,isLocked:t,password:n})),C.messageList=[]}function V(e,t){U.emit("channelJoin",JSON.stringify({name:C.userName,channelName:e,password:t})),C.messageList=[]}function j(){U.emit("channelList")}function z(e){U.emit("chatMessage",JSON.stringify({name:C.userName,channel:C.nowChannel,msg:e}))}U.on("connect",(()=>{console.log("socket connected"),C.connected=!0})),U.on("disconnect",(()=>{console.log("socket disconnected"),C.connected=!1})),U.on("message",(async e=>{try{e=JSON.parse(e)}catch(t){console.error(t)}switch(e.type){case"login":e.success?(C.channelList=e.channels,console.log("Login success!!")):console.error("Already Logined in Server!!");break;case"channelCreate":e.success?(C.nowChannel=e.channelName,je.push("/chat")):console.error("channel name already exits");break;case"channelJoin":e.success?(C.nowChannel=e.channelName,C.userList=e.candidate,je.push("/chat")):console.error(e.msg);break;case"userJoin":C.userList.push(e.user),C.messageList.push({user:"서버 관리자",msg:e.user.name+"님이 참가하셨습니다."}),console.log("userJoin");break;case"channelList":C.channelList=e.channels,console.log(C.channelList);break;case"chatMessage":C.messageList.push({user:e.user,msg:e.msg}),console.log(e.user+" "+e.msg);break;case"stream":const t=await navigator.mediaDevices.getUserMedia(D),n=document.querySelector("#localVideo");n.srcObject=t,n.onloadedmetadata=()=>{n.play()};let s=null;for(let o=0;o<C.userList.length;o++)if(C.userList[o].name===e.name){s=$.call(e.peerId,t);break}s.on("stream",(t=>{const n=document.querySelector("#"+e.name);n.srcObject=t,n.onloadedmetadata=()=>{n.play()},console.log("remoteVideo started")}));break}}));const $=new N._z({config:P});$.on("open",(async function(e){C.peerId=e,console.log("p2pSocket opened id: ",C.peerId)}));const T=async()=>{try{const e=await navigator.mediaDevices.getUserMedia(D),t=document.querySelector("#localVideo");t.srcObject=e,t.onloadedmetadata=()=>{t.play()},console.log("localVideo started"),$.on("call",(function(t){t.answer(e)})),console.log("send server request"),U.emit("start-stream",JSON.stringify({peerId:C.peerId,name:C.userName,channel:C.nowChannel}))}catch(e){console.error("Error in startStream: ",e)}};var B={name:"LoginPage",data(){return{userId:"",userPw:"",loginState:!1}},methods:{async login(){alert("Login");const e=this.$store.getters.getServerURL;console.log("Login attempt, ID: "+this.userId),console.log("PW: "+this.userPw);this.userId,this.userPw;let t=(await _.Z.get(e+"/login",{params:{id:this.userId,pw:this.userPw}})).data;if(t.state){let e={userId:this.userId,userPw:this.userPw,userName:t.userName};console.log(e),this.$store.commit("setuserInfo",e),this.$store.commit("setIsLogined",!0),C.userName=t.userName,await je.push("/main")}else alert("아이디 혹은 비밀번호가 옳바르지 않습니다. 다시 로그인해주세요!")},connect(){const e=this.$store.getters.getServerURL;let t=new k.io(e);t.on("connect",(()=>{console.log(t.id),this.connected=!0}))}}};const q=(0,i.Z)(B,[["render",I]]);var J=q;const Z={id:"find"};function W(e,t,n,r,a,i){return(0,o.wg)(),(0,o.iD)("div",Z,[(0,o.Uk)(" 찾으려는 ID: "),(0,o.wy)((0,o._)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>a.findId=e),type:"text",onKeyup:t[1]||(t[1]=(...e)=>i.findEnter&&i.findEnter(...e))},null,544),[[s.nr,a.findId]]),(0,o._)("button",{onClick:t[2]||(t[2]=(...e)=>i.find&&i.find(...e))},"비밀번호 찾기")])}var R={name:"PwFind.vue",data(){return{findId:""}},methods:{findEnter(e){13===e.keyCode&&""!==this.findId&&this.find()},async find(){const e=this.$store.getters.getServerURL;console.log("Find ID attempt, ID: "+this.findId);let t=(await _.Z.get(e+"/login/find",{params:{id:this.findId}})).data;t.state?alert("입력하신 아이디의 비밀번호는 "+t.findPw+" 입니다"):alert("입력하신 아이디를 찾을 수 없습니다. 다시 시도해주세요!"),alert("Test"),je.push({path:"/"})}}};const A=(0,i.Z)(R,[["render",W]]);var E=A;const K={id:"login"},H=(0,o._)("div",{class:"loginText"},"회원가입",-1),Y={class:"loginBox"},F={class:"idin"},G={key:0,class:"checkImg1",src:d,alt:""},Q={class:"pwin"},X={key:0,class:"checkImg2",src:d,alt:""},ee={class:"nickin"},te={key:0,class:"checkImg3",src:d,alt:""};function ne(e,t,n,r,a,i){return(0,o.wg)(),(0,o.iD)("div",K,[H,(0,o._)("div",Y,[(0,o._)("div",F,[(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{class:"inputBox",type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.userId=e),placeholder:"ID"},null,512),[[s.nr,a.userId]]),a.userId.length>=4?((0,o.wg)(),(0,o.iD)("img",G)):(0,o.kq)("",!0)])]),(0,o._)("div",Q,[(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{class:"inputBox",type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.userPw=e),placeholder:"비밀번호"},null,512),[[s.nr,a.userPw]]),a.userPw.length>=6?((0,o.wg)(),(0,o.iD)("img",X)):(0,o.kq)("",!0)])]),(0,o._)("div",ee,[(0,o._)("div",null,[(0,o.wy)((0,o._)("input",{class:"inputBox",type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>a.userName=e),placeholder:"닉네임"},null,512),[[s.nr,a.userName]]),a.userName.length>=3?((0,o.wg)(),(0,o.iD)("img",te)):(0,o.kq)("",!0)])]),(0,o._)("button",{class:"createButton",onClick:t[3]||(t[3]=(...e)=>i.create&&i.create(...e))},"회원가입")])])}var se={name:"SignUp",data(){return{userId:"",userPw:"",userName:""}},methods:{async create(){const e=this.$store.getters.getServerURL;if(console.log("회원가입 시도!"),this.userId.length<4)return void alert("아이디 길이는 4 이상이어야 합니다.");if(this.userPw.length<6)return void alert("비밀번호 길이는 6 이상이어야 합니다.");if(this.userName.length<3)return void alert("닉네임 길이는 3 이상이어야 합니다.");let t=(await _.Z.post(e+"/login/create",{params:{id:this.userId,pw:this.userPw,name:this.userName}})).data;t.state?(alert("회원가입 완료!"),await this.$router.push({path:"/"})):alert("기존에 존재하는 아이디및 닉네임입니다!")}}};const oe=(0,i.Z)(se,[["render",ne]]);var re=oe;const ae=e=>((0,o.dD)("data-v-b2ec3230"),e=e(),(0,o.Cn)(),e),ie=ae((()=>(0,o._)("div",null,"공사중",-1))),le={id:"upperbar"},ce={id:"channellist"};function ue(e,t,n,s,r,a){const i=(0,o.up)("TextBox");return(0,o.wg)(),(0,o.iD)(o.HY,null,[ie,(0,o._)("button",{onClick:t[0]||(t[0]=(...e)=>a.test&&a.test(...e))},"테스트방 생성"),(0,o._)("button",{onClick:t[1]||(t[1]=(...e)=>a.test1&&a.test1(...e))},"테스트방 참가"),(0,o._)("div",le,[(0,o.Wm)(i,{class:"user-info-box",text:this.getUserName,size:"150"},null,8,["text"]),(0,o.Wm)(i,{class:"logout",onClick:a.logout,text:"Logout",size:"75"},null,8,["onClick"])]),((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.getChannelInfo,(e=>((0,o.wg)(),(0,o.iD)("div",ce,[(0,o.Wm)(i,{class:"channelName",text:e.name,size:"150"},null,8,["text"]),(0,o.Wm)(i,{class:"channelUsers",text:e.users,size:"75"},null,8,["text"]),e.locked?((0,o.wg)(),(0,o.j4)(i,{key:0,class:"channelisLocked",text:"잠김",size:"75"})):(0,o.kq)("",!0)])))),256))],64)}var de=n(7139);const ge={class:"l-menu-text-box-text valign-text-middle"};function me(e,t,n,s,r,a){return(0,o.wg)(),(0,o.iD)("div",{style:(0,de.j5)(a.setStyle),class:(0,de.C_)(["l-menu-text-box",n.size||"",n.color||""])},[(0,o._)("div",ge,(0,de.zw)(n.text),1)],6)}var he={name:"TextBox",props:["text","size","color"],computed:{setStyle(){let e,t;return e=void 0==this.size?"150px":this.size,t=void 0==this.color?"black":this.color,{"--size":`${e}px`,"--color":`${t}`}}}};const pe=(0,i.Z)(he,[["render",me]]);var fe=pe,we={components:{TextBox:fe},name:"MainPage",data(){return{}},created(){this.isLogined?j():(alert("옳바르지 않은 접근입니다!"),je.push("/"))},computed:{getUserName(){return this.$store.getters.getUserInfo.userName+"님 환영합니다!"},isLogined(){return this.$store.getters.getIsLogined},getChannelInfo(){return C.channelList}},methods:{async test(){await O(),await M("test",!0,"wogh123")},async test1(){await O(),await V("test","wogh123")},async logout(){this.$store.commit("setIsLogined",!1),await je.push("/"),U.disconnect()}}};const ve=(0,i.Z)(we,[["render",ue],["__scopeId","data-v-b2ec3230"]]);var ye=ve;const Ie=e=>((0,o.dD)("data-v-5c05f1fa"),e=e(),(0,o.Cn)(),e),ke={class:"chat-container"},_e=Ie((()=>(0,o._)("div",{class:"video-chat-local"},[(0,o._)("video",{id:"localVideo",autoplay:"",playsinline:""})],-1))),Le={class:"video-chat-remote-list"},be={id:"video-chat-remote-users"},xe=Ie((()=>(0,o._)("video",{class:"remoteVideo",id:"user.name",autoplay:"",playsinline:""},null,-1))),Ne={class:"chat"},Ce={id:"messages"},Se=Ie((()=>(0,o._)("button",{type:"submit"},"Send",-1)));function Pe(e,t,n,r,a,i){return(0,o.wg)(),(0,o.iD)("div",ke,[_e,(0,o._)("div",Le,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.getUserList,(e=>((0,o.wg)(),(0,o.iD)("div",be,[xe,(0,o._)("label",null,(0,de.zw)(e.name),1)])))),256))]),(0,o._)("div",Ne,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(this.getMessage,(e=>((0,o.wg)(),(0,o.iD)("div",Ce,(0,de.zw)(e.user)+" ) "+(0,de.zw)(e.msg)+" || ",1)))),256)),(0,o._)("form",{onSubmit:t[1]||(t[1]=(0,s.iM)(((...e)=>i.sendMessage&&i.sendMessage(...e)),["prevent"]))},[(0,o.wy)((0,o._)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>a.newMessage=e),placeholder:"Type your message"},null,512),[[s.nr,a.newMessage]]),Se],32)]),(0,o._)("button",{onClick:t[2]||(t[2]=(...e)=>i.switchVideoCall&&i.switchVideoCall(...e))},"VideoChat"),(0,o._)("button",{onClick:t[3]||(t[3]=(...e)=>i.switchAudioCall&&i.switchAudioCall(...e))},"AudioChat")])}var De={data(){return{newMessage:""}},created(){this.$store.getters.getIsLogined&&C.nowChannel||(alert("옳바르지 않은 접근입니다!"),je.push("/"))},methods:{sendMessage(){z(this.newMessage),this.newMessage=""},switchVideoCall(){D.video=!0,T()},switchAudioCall(){D.video=!1,T()}},computed:{state(){return C},getMessage(){return C.messageList},getUserList(){return C.userList}}};const Ue=(0,i.Z)(De,[["render",Pe],["__scopeId","data-v-5c05f1fa"]]);var Oe=Ue;const Me=[{path:"/",name:"login,",component:J},{path:"/find",name:"find,",component:E},{path:"/create",name:"SignUp",component:re},{path:"/main",name:"main",component:ye},{path:"/chat",name:"chat",component:Oe}],Ve=(0,u.p7)({history:(0,u.PO)("/"),routes:Me});var je=Ve;(0,s.ri)(c).use(x).use(je).mount("#app")}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,s,o,r){if(!s){var a=1/0;for(u=0;u<e.length;u++){s=e[u][0],o=e[u][1],r=e[u][2];for(var i=!0,l=0;l<s.length;l++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](s[l])}))?s.splice(l--,1):(i=!1,r<a&&(a=r));if(i){e.splice(u--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[s,o,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.p="/"}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,s){var o,r,a=s[0],i=s[1],l=s[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(o in i)n.o(i,o)&&(n.m[o]=i[o]);if(l)var u=l(n)}for(t&&t(s);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},s=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(3945)}));s=n.O(s)})();
//# sourceMappingURL=app.0fb2a2e0.js.map